
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Nome do Jogo</title>
  <meta name="author" content="Carlos Brando">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="canonical" href="http://nomedojogo.com/page/23/index.html"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds2.feedburner.com/NomeDoJogo" rel="alternate" title="Nome do Jogo" type="application/atom+xml"/>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1249636-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Nome do Jogo</a></h1>
  
    <h2>por Carlos Brando</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="http://feeds2.feedburner.com/NomeDoJogo" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:nomedojogo.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Arquivo</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/10/01/shoulda-20/">Shoulda 2.0</a></h1>
    
    
      <p class="meta">




<time datetime="2008-10-01 00:00:00 -0300" pubdate  updated > 1 de Outubro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Outro projeto open-source que também participo e gosto muito é o <strong>Shoulda</strong>. Já tentei <a href="http://www.nomedojogo.com/2008/08/05/porque-eu-defendo-o-shoulda/">explicar no passado</a> o motivo de gostar tanto deste projeto, mas acho que tem muito a ver com uma questão de puro gosto.</p>

<p>Pois bem, acabou de ser liberada a versão 2.0.2 do <strong>Shoulda</strong> e a principal novidade é que agora ele funciona 100% como um gem. Além disso, novas macros foram acrescentadas, bugs foram corrigidos e algumas funcionalidades foram removidas.</p>

<p>Para utilizar o Shoulda em seu projeto Rails 2.1+ a melhor forma é acrescentar o seguinte código no seu arquivo <strong>config/environment.rb</strong>:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails source_ruby_rails_shoulda"><span class="support support_class support_class_ruby">Rails</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">Initializer</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>run <span class="keyword keyword_control keyword_control_start-block keyword_control_start-block_ruby">do </span><span class="punctuation punctuation_separator punctuation_separator_variable punctuation_separator_variable_ruby">|</span><span class="variable variable_other variable_other_block variable_other_block_ruby">config</span><span class="punctuation punctuation_separator punctuation_separator_variable punctuation_separator_variable_ruby">|</span>
  config<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>gem <span class="string string_quoted string_quoted_single string_quoted_single_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">'</span>thoughtbot-shoulda<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">'</span></span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>lib</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="string string_quoted string_quoted_single string_quoted_single_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">'</span>shoulda/rails<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">'</span></span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span>
    <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>source</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="string string_quoted string_quoted_double string_quoted_double_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">"</span>http://gems.github.com<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">"</span></span>
<span class="keyword keyword_control keyword_control_ruby">end</span></span></pre>


<p>Depois basta executar no terminal:</p>

<pre class="textmate-source"><span class="text text_html text_html_basic">rake gems:install
rake gems:unpack
</span></pre>


<p>Entre as novidades, tivemos melhorias em macros existentes que prometem agilizar ainda mais a criação de testes, tais como o acréscimo das opções <strong>:equals</strong> e <strong>:class</strong> na macro <strong>should_assign_to</strong>. Com estas novas implementações fica fácil testar se o objeto devolvido é do tipo desejado ou mesmo igual a um objeto especifico.</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails source_ruby_rails_shoulda"><span class="support support_shoulda support_shoulda_macro">should_assign_to</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>user</span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>equals</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="string string_quoted string_quoted_double string_quoted_double_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">"</span>@user<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">"</span></span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>class</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="variable variable_other variable_other_constant variable_other_constant_ruby">User</span></span></pre>


<p>A macro <strong>should_have_one</strong> também recebeu a opção <strong>:dependent</strong>:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails source_ruby_rails_shoulda"><span class="support support_shoulda support_shoulda_macro">should_have_one</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>address</span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>dependent</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>destroy</span></span></pre>


<p>Agora falando apenas de novidades, temos as novas macros <strong>should_change</strong>, <strong>should_not_change</strong>, <strong>should_filter_params</strong>, <strong>should_render_with_layout</strong>, <strong>should_render_without_layout</strong>, <strong>should_route</strong>, <strong>should_respond_with_content_type</strong>, <strong>should_return_from_session</strong> e o muito útil <strong>before_should</strong>.</p>

<p>Mais detalhes sobre o funcionamento de todas estas macros podem ser encontrados na <a href="http://dev.thoughtbot.com/shoulda/">documentação</a> do projeto.</p>

<p>Algo interessante que também foi acrescentado ao projeto é a carga automática de macros customizadas. Caso você deseje criar suas próprias macros, basta criar uma pasta <strong>RAILS_ROOT/test/shoulda_macros</strong> e jogar lá dentro os arquivos com estas macros.</p>

<p>Gems e plugins também podem se beneficiar dessa vantagem. Se em qualquer um deles houver uma pasta <strong>shoulda_macros</strong> na raiz, todos os arquivos dentro da pasta também serão carregados automaticamente.</p>

<p>A única controvérsia desta versão, foi a remoção do método <strong>should_be_restful</strong>. Na verdade ele chegou a ser removido por alguns dias, mas depois voltou com uma mensagem de alerta avisando que em breve ele será removido definitivamente. Isto se dá pelo fato de que este método faz muita coisa de forma automática e não permite uma fácil localização do ponto onde um erro ocorre.</p>

<p>Um outro projeto também foi iniciado em paralelo ao desenvolvimento do <strong>Shoulda</strong>. O <a href="http://github.com/seanhussey/woulda">Woulda</a> promete ser um repositório de macros e recursos que não cabem ao Shoulda, como macros especificas para testar alguns gems/plugins famosos.</p>

<p>Para quem está começando a brincar com o <strong>Shoulda</strong> segue uma lista de recursos interessantes:</p>

<ul>
    <li><a href="http://www.makemesimple.com/blog/2008/06/27/learncast1-bdd-leve-com-shoulda-testando-modelos-activerecord/">Screencast BDD leve com Shoulda - testando modelos ActiveRecord</a></li>
    <li><a href="http://jonysk.net/blog/2008/08/17/shoulda-x-rspec-cuidado-nas-comparacoes/">Shoulda x RSpec: Cuidado nas comparações</a></li>
    <li><a href="http://kylebanker.com/blog/2008/09/shoulda-testing-cheat-sheet/"><span id="repository_description">Shoulda Testing Cheat Sheet</span></a></li>
    <li><a href="http://groups.google.com/group/shoulda/browse_thread/thread/5aef44642bbda277"> Running single shoulda tests from the command line</a></li>
    <li><a href="http://www.thoughtbot.com/projects/shoulda">Making Tests Easy on the Fingers and Eyes</a></li>
</ul>


<p>O <a href="http://github.com/drnic/ruby-shoulda-tmbundle/tree/master">Bundle para o TextMate</a> que estou mantendo junto com o Dr. Nic no GitHub já está atualizado com todos os recursos da versão 2.0.2.</p>
</div>
  <footer>
    <a rel="full-article" href="/2008/10/01/shoulda-20/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/10/01/falta-uma-semana-para-o-inicio-do-curso-ruby-on-rails-2-do-basico-ao-avancado/">Falta uma semana para o inicio do curso &#8220;Ruby on Rails 2 do básico ao avançado&#8221;</a></h1>
    
    
      <p class="meta">




<time datetime="2008-10-01 00:00:00 -0300" pubdate  updated > 1 de Outubro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Falta menos de uma semana para o inicio do curso &#8221;<a href="http://www.egenial.com.br/cursorails/como">Ruby on Rails 2 do básico ao avançado</a>&#8221;.</p>

<p>Este curso online foi feito para programadores que desejam aprender essa nova plataforma de desenvolvimento Web e para programadores que conhecem Rails e desejam expandir seus conhecimentos em áreas mais avançadas que ainda não usam.</p>

<p>Durante o curso os participantes terão acesso a aulas práticas e teóricas, com conteúdos em forma de textos didáticos, imagens e aulas interativas. Para cada aula didática teremos uma aula interativa, sempre no dia posterior, em um ambiente real de treinamento, com áudio, vídeo, chat e outros recursos para maior interatividade entre os participantes e instrutor. Nesta aula serão apresentados casos reais de desenvolvimento do dia a dia e correção dos exercícios propostos, além de tira-dúvidas.</p>

<p>O aluno ainda contará com um grupo de estudos para troca de experiências durante o curso em tempo integral, servindo também como um ponto de apoio ao aprendizado.</p>

<p>O investimento é de apenas <strong>2 x R$270,00</strong>, que representa um valor muito baixo em relação ao conteúdo do curso. Todo o material do curso é o mesmo das turmas anteriores que foram ministrados por Júlio Monteiro e Fábio Akita, mas totalmente atualizado para a versão atual do Rails e com algumas dicas do que teremos de novo no <strong>Rails 2.2</strong>.</p>

<p>Ainda restam poucas vagas, então aproveite e aprenda Ruby on Rails ainda este ano. <a href="http://www.egenial.com.br/cursorails/matricula">Clique aqui para se matricular</a>.</p>
</div>
  <footer>
    <a rel="full-article" href="/2008/10/01/falta-uma-semana-para-o-inicio-do-curso-ruby-on-rails-2-do-basico-ao-avancado/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/30/rails-podcast-brasil-episodio-32/">Rails Podcast Brasil - Episódio 32</a></h1>
    
    
      <p class="meta">




<time datetime="2008-09-30 00:00:00 -0300" pubdate  updated >30 de Setembro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Depois de uma temporada de seca e um episódio solo, estamos de volta com o Rails Podcast Brasil. Neste episódio decidimos testar um novo formato, com apenas as noticias mais relevantes para o mundo do Rails.</p>

<p>Um episódio menor, mais direto e informativo. Acreditamos que nossos ouvintes procuram no podcast uma forma rápida de se manter atualizados com a plataforma de desenvolvimento que escolheram.</p>

<p>O podcast desta semana tem aproximadamente 20 minutos de duração, e cobre as principais noticias da última semana, que você não poderia deixar de saber.</p>

<p>Gostaria de ouvir de nossos ouvintes o que acharam deste formato nos comentários.</p>

<p>E não se esqueça, o <a href="http://www.egenial.com.br/cursorails/como">curso de Ruby on Rails</a> já está para começar, se você ainda não se <a href="http://www.egenial.com.br/cursorails/matricula">matriculou</a>, já está na hora. O <a href="http://www.locaweb.com.br/railssummit/">Rails Summit Latin America</a> também está muito próximo, não perca.</p>

<p><img class="alignnone" src="http://old.nomedojogo.com/wp-content/uploads/2008/01/untitled-1.png" alt="" width="280" height="130" /></p>

<ul>
    <li><a href="http://www.fngtps.com/2008/09/activesupport-multibyte-updated">ActiveSupport::Multibyte Updated</a></li>
    <li><a href="http://blog.segment7.net/articles/2008/09/26/rubygems-1-3-0">RubyGems 1.3.0</a></li>
    <li><a href="http://www.railsenvy.com/2008/9/23/last-mvc-video">The Last MVC Video + Out-takes</a></li>
    <li><a href="http://blog.railsrumble.com/rules">Rails Rumble 2008</a></li>
    <li><a href="http://www.artweb-design.de/2008/9/19/rails-i18n-revs-up-globalize2-preview-released">Rails I18n revs up: Globalize2 preview released!</a></li>
    <li><a href="http://www.ruby-forum.com/topic/166392">RSpec &gt; plans for cucumber</a></li>
    <li><a href="http://peepcode.com/products/couchdb-with-rails">couchdb-with-rails</a></li>
    <li><a href="http://github.com/ariejan/baseapp/tree/master">baseapp</a></li>
    <li><a href="http://blog.areacriacoes.com.br/2008/9/18/include-require-load-e-extend-em-ruby">Include,require,load e extend em Ruby</a></li>
    <li><a href="http://github.com/nofxx/screencast_br/tree/master">screencast_br</a></li>
    <li><a href="http://www.railsinside.com/plugins/94-community-engine-social-networking-features-in-a-plugin.html">Community Engine: Social Networking Features in a Plugin</a></li>
    <li><a href="http://rafael.adm.br/p/o-valor-da-experiencia/">Podcast: Voltando pra Casa</a></li>
    <li><a href="http://www.rubyinside.com/jsclass-javascript-in-a-ruby-style-1219.html">JS.Class – JavaScript in a Ruby Style</a></li>
    <li><a href="http://www.nomedojogo.com/2008/09/24/porque-country_select-virou-um-plugin/">Porque country_select virou um plugin</a></li>
</ul>


<p>Download: <a href="http://download.podcast.rubyonrails.pro.br/RailsPodcastBrasil_032.mp3">Episódio #32</a>
iTunes: <a href="http://podcast.rubyonrails.pro.br/rss">http://podcast.rubyonrails.pro.br/rss</a>
Episódios anteriores: <a href="http://podcast.rubyonrails.pro.br/">http://podcast.rubyonrails.pro.br/</a></p>
</div>
  <footer>
    <a rel="full-article" href="/2008/09/30/rails-podcast-brasil-episodio-32/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/29/edge-rails-partials-nao-vao-mais-definir-as-variaveis-locais-implicitamente/">Edge Rails: Partials não vão mais definir as variáveis locais implicitamente</a></h1>
    
    
      <p class="meta">




<time datetime="2008-09-29 00:00:00 -0300" pubdate  updated >29 de Setembro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>No exemplo abaixo estou renderizando uma <strong>partial</strong>, e não estou informando qual variável ela deve usar para preencher o conteúdo. Hoje o Rails encara que como tenho uma variável de instância com o mesmo nome, implicitamente é esta que deve ser usada.</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails"><span class="variable variable_other variable_other_readwrite variable_other_readwrite_instance variable_other_readwrite_instance_ruby"><span class="punctuation punctuation_definition punctuation_definition_variable punctuation_definition_variable_ruby">@</span>customer</span> <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby">=</span> <span class="support support_class support_class_ruby">Customer</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span><span class="keyword keyword_other keyword_other_special-method keyword_other_special-method_ruby">new</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="string string_quoted string_quoted_double string_quoted_double_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">"</span>Carlos Brando<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">"</span></span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span>
<span class="support support_function support_function_actionpack support_function_actionpack_rails">render</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>partial</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="string string_quoted string_quoted_double string_quoted_double_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">"</span>customer<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">"</span></span></span></pre>


<p>Isto funciona mas é um pouco arriscado. A partir do Rails 2.2, esta funcionalidade continua funcionando mas sempre emitindo uma aviso de que será por pouco tempo:</p>

<pre class="textmate-source"><span class="text text_plain"><span class="meta meta_paragraph meta_paragraph_text">@customer will no longer be implicitly assigned to customer</span></span></pre>


<p>Sim, este recurso será removido do Rails no futuro.</p>

<hr /><em>Este artigo pertence a série “Edge Rails”. Todos os exemplos dados aqui funcionarão somente no <strong>Ruby on Rails 2.2 ou superior</strong>. A intenção desta série é preparar antecipadamente os programadores para as próximas versões do framework.</em>

</div>
  <footer>
    <a rel="full-article" href="/2008/09/29/edge-rails-partials-nao-vao-mais-definir-as-variaveis-locais-implicitamente/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/28/edge-rails-correcao-de-bug-no-metodo-count-do-activerecord/">Edge Rails: Correção de bug no método count do ActiveRecord</a></h1>
    
    
      <p class="meta">




<time datetime="2008-09-28 00:00:00 -0300" pubdate  updated >28 de Setembro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Existe um bug no método <strong>count</strong> do <strong>ActiveRecord</strong> quando usamos uma associação <strong>has_many</strong> em conjunto com a opção <strong>:limit</strong> ou <strong>:offset</strong>. Vejamos um exemplo:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails"><span class="meta meta_rails meta_rails_model"><span class="meta meta_class meta_class_ruby"><span class="keyword keyword_control keyword_control_class keyword_control_class_ruby">class</span> <span class="entity entity_name entity_name_type entity_name_type_class entity_name_type_class_ruby">Post<span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_ruby"> <span class="punctuation punctuation_separator punctuation_separator_inheritance punctuation_separator_inheritance_ruby">&lt;</span> ActiveRecord::Base</span></span></span>
  <span class="support support_function support_function_activerecord support_function_activerecord_rails">has_many</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>comments</span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>limit</span><span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="constant constant_numeric constant_numeric_ruby">2</span>
</span><span class="keyword keyword_control keyword_control_ruby">end</span>
</span></pre>


<p>No código acima quando tentarmos recuperar os comentários de um post, apenas 2 comentários devem ser retornados.</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails">post<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>comments<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>length <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> =&gt; 2
</span>
<span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> Veja o SQL usado:
</span><span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> SELECT * FROM "comments" WHERE
</span><span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> ("comments".post_id = 1) LIMIT 2
</span></span></pre>


<p>Mas, ao usarmos o método <strong>count</strong>:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails">post<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>comments<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>count <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> =&gt; 3
</span>
<span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> Veja o SQL usado:
</span><span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> SELECT count(*) AS count_all FROM "comments" WHERE
</span><span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> ("comments".post_id = 1)
</span></span></pre>


<p>Como você pode ver o erro ocorre porque a clausula <strong>LIMIT 2</strong> não foi incluída na query do SQL.</p>

<p>Obviamente isto já foi corrigido no Edge Rails e já estará funcionando no Rails 2.2.</p>

<hr /><em>Este artigo pertence a série “Edge Rails”. Todos os exemplos dados aqui funcionarão somente no <strong>Ruby on Rails 2.2 ou superior</strong>. A intenção desta série é preparar antecipadamente os programadores para as próximas versões do framework.</em>

</div>
  <footer>
    <a rel="full-article" href="/2008/09/28/edge-rails-correcao-de-bug-no-metodo-count-do-activerecord/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/27/edge-rails-metodo-count-do-activerecord-nao-inclui-um-alias-para-associacoes/">Edge Rails: Método count do ActiveRecord não inclui um alias para associações</a></h1>
    
    
      <p class="meta">




<time datetime="2008-09-27 00:00:00 -0300" pubdate  updated >27 de Setembro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Digamos que temos a seguinte associação <strong>has_many :through</strong>:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails"><span class="meta meta_rails meta_rails_model"><span class="meta meta_class meta_class_ruby"><span class="keyword keyword_control keyword_control_class keyword_control_class_ruby">class</span> <span class="entity entity_name entity_name_type entity_name_type_class entity_name_type_class_ruby">Author<span class="entity entity_other entity_other_inherited-class entity_other_inherited-class_ruby"> <span class="punctuation punctuation_separator punctuation_separator_inheritance punctuation_separator_inheritance_ruby">&lt;</span> ActiveRecord::Base</span></span></span>
  <span class="support support_function support_function_activerecord support_function_activerecord_rails">has_many</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>authorships</span>
  <span class="support support_function support_function_activerecord support_function_activerecord_rails">has_many</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>books</span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>through</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>authorships</span>
</span><span class="keyword keyword_control keyword_control_ruby">end</span>
</span></pre>


<p>Ao procurar por um livro você pode incluir a autoria em sua busca:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails">author<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>books<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>find<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>all</span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>include</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>authorships</span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span>
                  <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>conditions</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="punctuation punctuation_section punctuation_section_array punctuation_section_array_ruby">[</span><span class="string string_quoted string_quoted_double string_quoted_double_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">"</span>authorships.primary = ?<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">"</span></span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_language constant_language_ruby">true</span><span class="punctuation punctuation_section punctuation_section_array punctuation_section_array_ruby">]</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span>
</span></pre>


<p>Isto funciona muito bem, sem erros. Mas tente fazer o mesmo com o método <strong>count</strong>:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails">author<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>books<span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>count<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>include</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>authorships</span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span>
                   <span class="constant constant_other constant_other_symbol constant_other_symbol_ruby"><span class="punctuation punctuation_definition punctuation_definition_constant punctuation_definition_constant_ruby">:</span>conditions</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=&gt;</span> <span class="punctuation punctuation_section punctuation_section_array punctuation_section_array_ruby">[</span><span class="string string_quoted string_quoted_double string_quoted_double_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">"</span>authorships.primary = ?<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">"</span></span><span class="punctuation punctuation_separator punctuation_separator_object punctuation_separator_object_ruby">,</span> <span class="constant constant_language constant_language_ruby">true</span><span class="punctuation punctuation_section punctuation_section_array punctuation_section_array_ruby">]</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span></span></pre>


<p>Temos um erro. Isto acontece porque a tabela <strong>authorships</strong> foi incluída duas vezes na mesma query.</p>

<p>O método <strong>find</strong> é mais esperto, porque ele cria um apelido para a tabela, coisa que o método <strong>count</strong> não faz. Eu sei que o exemplo dado não é muito bom, mas é apenas para tentar mostrar o problema com o método <strong>count</strong>.</p>

<p>Esta falha foi corrigida. Agora o método count se comporta exatamente como o método find em relação ao <strong>:include</strong>.</p>

<hr /><em>Este artigo pertence a série “Edge Rails”. Todos os exemplos dados aqui funcionarão somente no <strong>Ruby on Rails 2.2 ou superior</strong>. A intenção desta série é preparar antecipadamente os programadores para as próximas versões do framework.</em>

</div>
  <footer>
    <a rel="full-article" href="/2008/09/27/edge-rails-metodo-count-do-activerecord-nao-inclui-um-alias-para-associacoes/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/26/edge-rails-troca-de-biblioteca-geradora-de-chaves-secretas/">Edge Rails: Troca de biblioteca geradora de chaves secretas</a></h1>
    
    
      <p class="meta">




<time datetime="2008-09-26 00:00:00 -0300" pubdate  updated >26 de Setembro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>A classe <strong>Rails::SecretKeyGenerator</strong>, usada para gerar chaves secretas aleatórias como as usadas para armazenar a sessão do usuário em cookies, está sendo marcada para ser removida do Rails (Deprecate).</p>

<p>Em seu lugar o Rails passará a usar a classe <strong>ActiveSupport::SecureRandom</strong> que foi feita para o Ruby 1.9. A biblioteca <strong>SecureRandom</strong> faz a mesma coisa que a anterior, mas um pouco melhor.</p>

<p>Esta nova biblioteca suporta os seguintes geradores de números aleatórios:</p>

<ul>
    <li><span class="c1">openssl</span></li>
    <li><span class="c1">/dev/urandom</span></li>
    <li><span class="c1">Win32</span></li>
</ul>


<p>Vejamos alguns exemplos de chaves geradas com esta nova biblioteca:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails"><span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> random hexadecimal string.
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>hex<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">10</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "52750b30ffbc7de3b362"
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>hex<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">10</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "92b15d6c8dc4beb5f559"
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>hex<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">11</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "6aca1b5c58e4863e6b81b8"
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>hex<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">12</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "94b2fff3e7fd9b9c391a2306"
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>hex<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">13</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "39b290146bea6ce975c37cfc23"
</span>
<span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> random base64 string.
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>base64<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">10</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "EcmTPZwWRAozdA=="
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>base64<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">10</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "9b0nsevdwNuM/w=="
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>base64<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">10</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "KO1nIU+p9DKxGg=="
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>base64<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">11</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "l7XEiFja+8EKEtY="
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>base64<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">12</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "7kJSM/MzBJI+75j8"
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>base64<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">13</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "vKLJ0tXBHqQOuIcSIg=="
</span>
<span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> random binary string.
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>random_bytes<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">10</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "\016\t{\370g\310pbr\301"
</span><span class="support support_class support_class_ruby">ActiveSupport</span><span class="punctuation punctuation_separator punctuation_separator_other punctuation_separator_other_ruby">::</span><span class="support support_class support_class_ruby">SecureRandom</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>random_bytes<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">10</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span> <span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span>=&gt; "\323U\030TO\234\357\020\a\337"</span></span></pre>


<hr /><em>Este artigo pertence a série “Edge Rails”. Todos os exemplos dados aqui funcionarão somente no <strong>Ruby on Rails 2.2 ou superior</strong>. A intenção desta série é preparar antecipadamente os programadores para as próximas versões do framework.</em>

</div>
  <footer>
    <a rel="full-article" href="/2008/09/26/edge-rails-troca-de-biblioteca-geradora-de-chaves-secretas/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/25/edge-rails-nova-versao-destrutiva-dos-metodos-de-pesquisa-do-activerecord/">Edge Rails: Nova versão destrutiva dos métodos de pesquisa do ActiveRecord</a></h1>
    
    
      <p class="meta">




<time datetime="2008-09-25 00:00:00 -0300" pubdate  updated >25 de Setembro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Os métodos dinâmicos de pesquisa do <strong>ActiveRecord</strong> receberam uma versão destrutiva, que dispara um erro do tipo <strong>RecordNotFound</strong> caso nenhum registro seja encontrado, ao invés de apenas retornar <strong>nil</strong> como acontece com a versão original.</p>

<p>Para usar esta versão destrutiva, basta adicionar o sinal de exclamação no final do método. Veja um exemplo:</p>

<pre class="textmate-source"><span class="source source_ruby source_ruby_rails"><span class="support support_class support_class_ruby">Topic</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>find_by_title!<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="string string_quoted string_quoted_double string_quoted_double_ruby"><span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_begin punctuation_definition_string_begin_ruby">"</span>The First Topic!<span class="punctuation punctuation_definition punctuation_definition_string punctuation_definition_string_end punctuation_definition_string_end_ruby">"</span></span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span>
<span class="comment comment_line comment_line_number-sign comment_line_number-sign_ruby"><span class="punctuation punctuation_definition punctuation_definition_comment punctuation_definition_comment_ruby">#</span> =&gt; ActiveRecord::RecordNotFound</span></span></pre>


<p>Esta alteração é muito bem vinda.</p>

<hr /><em>Este artigo pertence a série “Edge Rails”. Todos os exemplos dados aqui funcionarão somente no <strong>Ruby on Rails 2.2 ou superior</strong>. A intenção desta série é preparar antecipadamente os programadores para as próximas versões do framework.</em>

</div>
  <footer>
    <a rel="full-article" href="/2008/09/25/edge-rails-nova-versao-destrutiva-dos-metodos-de-pesquisa-do-activerecord/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/24/porque-country_select-virou-um-plugin/">Porque country_select virou um plugin</a></h1>
    
    
      <p class="meta">




<time datetime="2008-09-24 00:00:00 -0300" pubdate  updated >24 de Setembro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Ontem eu <a href="http://www.nomedojogo.com/2008/09/23/edge-rails-country_select-removido-do-rails/">mencionei</a> aqui no blog que o helper <strong>country_select</strong> foi removido do Rails e virou um plugin. Eu não tinha entendido muito bem, mas o <a href="http://queroseragil.wordpress.com/">Rafael Mueller</a> me ajudou a esclarecer o assunto.</p>

<p>O problema todo é que Taiwan segundo a norma ISO 3166, se chama na verdade &#8220;Taiwan, Province of China&#8221;. E foi exatamente assim que Michael Koziarski deixou no método.</p>

<p>Então, Jamis Buck questionou se não seria possível deixar apenas &#8220;Taiwan&#8221;, já que o &#8220;Province of China&#8221; parece ser politicamente agressivo. No GitHub iniciou-se então uma série de <a href="http://github.com/rails/rails/commit/3353b85b0eae76bf36ae7c2f7b6adc1863278a8e#comments">comentários</a> que foram entrando cada vez mais em questões politicas e deixando o técnico totalmente de lado.</p>

<p>Mas, Michael Koziarski foi categórico em afirmar que essas questões politicas estão muito além do que poderíamos resolver com uma simples alteração no código. E se aceitasse esta alteração, logo outras seriam solicitadas para países como Kosovo, Ossétia do Sul, Abecásia, Transnístria e uma longa lista.</p>

<p>A melhor solução, ou pelo menos a que geraria menos controvérsias, foi remover o helper do Rails e disponibiliza-lo na forma de um <a href="http://github.com/rails/country_select/tree/master">plugin</a>. Desta forma qualquer um poderia facilmente criar um fork e montar sua própria lista da forma como mais lhe agradar.</p>

<p>Foi uma ótima forma de resolver o conflito.</p>

<p>Apenas uma correção: No último post mencionei que gravariamos no banco de dados apenas a sigla do nome do país. Isto não é verdade, continuaremos gravando o nome inteiro do país, mas com a nova nomenclatura.</p>

<hr /><em>Este artigo pertence a série “Edge Rails”. Todos os exemplos dados aqui funcionarão somente no <strong>Ruby on Rails 2.2 ou superior</strong>. A intenção desta série é preparar antecipadamente os programadores para as próximas versões do framework.</em>

</div>
  <footer>
    <a rel="full-article" href="/2008/09/24/porque-country_select-virou-um-plugin/">Leia mais &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/23/esqueca-atribuicoes-em-massa-no-rails-pelo-menos-por-enquanto/">Esqueça atribuições em massa no Rails, pelo menos por enquanto</a></h1>
    
    
      <p class="meta">




<time datetime="2008-09-23 00:00:00 -0300" pubdate  updated >23 de Setembro de 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Lembra-se destes dois artigos?</p>

<ul>
    <li><a href="http://www.nomedojogo.com/2008/07/28/edge-rails-usando-a-opcao-accessible-para-fazer-atribuicoes-em-massa-no-activerecord/">Edge Rails: Usando a opção :accessible para fazer atribuições em massa no ActiveRecord</a></li>
    <li><a href="http://www.nomedojogo.com/2008/07/29/edge-rails-fazendo-uso-da-opcao-accessible-em-formularios/">Edge Rails: Fazendo uso da opção accessible em formulários</a></li>
</ul>


<p>Pois bem, esqueça. Esta funcionalidade foi removida do Rails, pois não estava totalmente completa e não daria tempo de terminar tudo até o lançamento do Rails 2.2.</p>

<p>Provavelmente ela deve voltar no futuro, mas dificilmente a tempo do próximo release.</p>

<hr /><em>Este artigo pertence a série “Edge Rails”. Todos os exemplos dados aqui funcionarão somente no <strong>Ruby on Rails 2.2 ou superior</strong>. A intenção desta série é preparar antecipadamente os programadores para as próximas versões do framework.</em>

</div>
  <footer>
    <a rel="full-article" href="/2008/09/23/esqueca-atribuicoes-em-massa-no-rails-pelo-menos-por-enquanto/">Leia mais &rarr;</a>
  </footer>


  </article>

<nav role="pagination">
  <div>
    
      <a class="prev" href="/page/24/">&larr; Antigos</a>
    
    <a href="/blog/archives">Arquivo</a>
    
    <a class="next" href="/page/22/">Novos &rarr;</a>
    
  </div>
</nav>

<script type="text/javascript">
    var disqus_shortname = 'carlosbrando';
    (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</div>
<aside role=sidebar>
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2011/08/19/blogando-como-um-hacker/">Blogando Como Um Hacker</a>
      </li>
    
      <li class="post">
        <a href="/2011/06/13/a-regra-direita-esquerda-do-c/">A Regra Direita-Esquerda do C</a>
      </li>
    
      <li class="post">
        <a href="/2011/06/03/colorific/">Colorific</a>
      </li>
    
      <li class="post">
        <a href="/2011/03/29/quem-disse-que-gravar-um-podcast-e-facil/">Quem disse que gravar um podcast é fácil?</a>
      </li>
    
      <li class="post">
        <a href="/2011/03/24/convite-para-o-grok-podcast/">Convite para o Grok Podcast!</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("carlosbrando", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/carlosbrando" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @carlosbrando</a>
  
</section>




  
</aside>

    </div>
  </div>
  <footer><p>
  Copyright &copy; 2011 - Carlos Brando -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
</body>
</html>
